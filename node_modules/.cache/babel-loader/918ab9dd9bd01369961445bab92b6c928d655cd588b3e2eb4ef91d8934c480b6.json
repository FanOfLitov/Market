{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\User\\\\Documents\\\\GitHub\\\\Market\\\\src\\\\components\\\\Productservice\\\\ProductCard.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport StarRating from '../Shared/StarRating';\nimport { formatPrice } from '../../utils/format';\nimport { getProductRating } from '../../services/reviews';\nimport { addToCart } from '../../services/cart';\nimport { useNavigate, Link } from 'react-router-dom';\nimport { useToast } from '../Shared/ToastProvider';\nimport { getRolesFromToken } from '../../utils/jwt';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst PRODUCTS_API = process.env.REACT_APP_PRODUCTS_URL || 'http://localhost:8072/productservice/api/v1';\nconst extractAttachmentIds = p => {\n  if (Array.isArray(p === null || p === void 0 ? void 0 : p.attachments) && p.attachments.length) {\n    return p.attachments.map(a => (a === null || a === void 0 ? void 0 : a.gridFsId) || (a === null || a === void 0 ? void 0 : a.id) || a).filter(Boolean);\n  }\n  if (p !== null && p !== void 0 && p.mainAttachmentId) return [p.mainAttachmentId];\n  return [];\n};\nconst getRatingValue = p => {\n  var _ref, _ref2, _ref3, _p$rating;\n  const v = (_ref = (_ref2 = (_ref3 = (_p$rating = p === null || p === void 0 ? void 0 : p.rating) !== null && _p$rating !== void 0 ? _p$rating : p === null || p === void 0 ? void 0 : p.ratingAverage) !== null && _ref3 !== void 0 ? _ref3 : p === null || p === void 0 ? void 0 : p.avgRating) !== null && _ref2 !== void 0 ? _ref2 : p === null || p === void 0 ? void 0 : p.averageRating) !== null && _ref !== void 0 ? _ref : 0;\n  const n = Number(v);\n  return Number.isFinite(n) ? n : 0;\n};\nconst getRatingCount = p => {\n  var _ref4, _ref5, _ref6, _p$ratingCount;\n  const c = (_ref4 = (_ref5 = (_ref6 = (_p$ratingCount = p === null || p === void 0 ? void 0 : p.ratingCount) !== null && _p$ratingCount !== void 0 ? _p$ratingCount : p === null || p === void 0 ? void 0 : p.reviewsCount) !== null && _ref6 !== void 0 ? _ref6 : p === null || p === void 0 ? void 0 : p.reviewCount) !== null && _ref5 !== void 0 ? _ref5 : p === null || p === void 0 ? void 0 : p.ratingsCount) !== null && _ref4 !== void 0 ? _ref4 : 0;\n  const n = Number(c);\n  return Number.isFinite(n) ? n : 0;\n};\nconst useInViewportOnce = (threshold = 0.2) => {\n  _s();\n  const ref = useRef(null);\n  const [visible, setVisible] = useState(false);\n  useEffect(() => {\n    const el = ref.current;\n    if (!el || visible) return;\n    const obs = new IntersectionObserver(([entry]) => {\n      if (entry.isIntersecting) {\n        setVisible(true);\n        obs.disconnect();\n      }\n    }, {\n      threshold\n    });\n    obs.observe(el);\n    return () => obs.disconnect();\n  }, [visible]);\n  return [ref, visible];\n};\n_s(useInViewportOnce, \"F7BtIAxVh3vOWU1Jr24RYsj9CHc=\");\nconst ProductCard = ({\n  product,\n  canManage,\n  onEdit,\n  showBuy = true,\n  showUpload = false,\n  onUpload,\n  onRequireAuth,\n  onSetMainAttachment,\n  onDeleteAttachment,\n  stockInfo,\n  onOpenStock\n}) => {\n  _s2();\n  const requireAuth = typeof onRequireAuth === 'function' ? onRequireAuth : () => alert('Нужно войти');\n  const initialAvg = getRatingValue(product);\n  const initialCnt = getRatingCount(product);\n  const [avg, setAvg] = useState(initialAvg);\n  const [count, setCount] = useState(initialCnt);\n  const [ratingLoading, setRatingLoading] = useState(false);\n  const token = useMemo(() => localStorage.getItem('jwtToken'), []);\n  const roles = useMemo(() => token ? getRolesFromToken(token) : [], [token]);\n  const isUser = roles.includes('USER') || roles.includes('ROLE_USER');\n  const productId = useMemo(() => product.productUUID || product.id, [product]);\n  const navigate = useNavigate();\n  const openDetails = e => {\n    if (e.target.closest('[data-role=\"gallery-control\"]')) return;\n    if (!productId) return;\n    navigate(`/product/${productId}`);\n  };\n  const initialIds = useMemo(() => extractAttachmentIds(product), [product]);\n  const [attachmentIds, setAttachmentIds] = useState(initialIds);\n  const [fetchedAll, setFetchedAll] = useState(Array.isArray(product === null || product === void 0 ? void 0 : product.attachments) && product.attachments.length > 0);\n  const [currentIdx, setCurrentIdx] = useState(0);\n  const [hostRef, inView] = useInViewportOnce(0.2);\n  const imageId = attachmentIds[currentIdx];\n  const imgSrc = inView && imageId ? `${PRODUCTS_API}/products/${imageId}/attachments-fs` : null;\n  const fetchAllIds = useCallback(async () => {\n    if (fetchedAll || !productId) return false;\n    try {\n      const res = await fetch(`${PRODUCTS_API}/products/${productId}/attachments`);\n      if (!res.ok) return false;\n      const list = await res.json();\n      const ids = Array.isArray(list) ? list.map(a => (a === null || a === void 0 ? void 0 : a.gridFsId) || (a === null || a === void 0 ? void 0 : a.id)).filter(Boolean) : [];\n      if (ids.length) {\n        setAttachmentIds(ids);\n        setFetchedAll(true);\n        setCurrentIdx(i => Math.min(i, ids.length - 1));\n        return true;\n      }\n    } catch {}\n    return false;\n  }, [fetchedAll, productId]);\n  useEffect(() => {\n    let cancelled = false;\n    (async () => {\n      if (!inView) return;\n      if (attachmentIds.length > 0) return;\n      const ok = await fetchAllIds();\n      if (!cancelled && !ok) {}\n    })();\n    return () => {\n      cancelled = true;\n    };\n  }, [inView, attachmentIds.length, fetchAllIds]);\n  const goPrev = useCallback(async e => {\n    var _e$stopPropagation;\n    e === null || e === void 0 ? void 0 : (_e$stopPropagation = e.stopPropagation) === null || _e$stopPropagation === void 0 ? void 0 : _e$stopPropagation.call(e);\n    if (!fetchedAll && attachmentIds.length <= 1) {\n      const ok = await fetchAllIds();\n      if (!ok || attachmentIds.length <= 1) return;\n    }\n    setCurrentIdx(i => (i - 1 + attachmentIds.length) % attachmentIds.length);\n  }, [fetchedAll, attachmentIds.length, fetchAllIds]);\n  const goNext = useCallback(async e => {\n    var _e$stopPropagation2;\n    e === null || e === void 0 ? void 0 : (_e$stopPropagation2 = e.stopPropagation) === null || _e$stopPropagation2 === void 0 ? void 0 : _e$stopPropagation2.call(e);\n    if (!fetchedAll && attachmentIds.length <= 1) {\n      const ok = await fetchAllIds();\n      if (!ok || attachmentIds.length <= 1) return;\n    }\n    setCurrentIdx(i => (i + 1) % attachmentIds.length);\n  }, [fetchedAll, attachmentIds.length, fetchAllIds]);\n  const hasCarousel = attachmentIds.length > 1;\n  const uploadInputId = `upload-${productId}`;\n  const handleFileChange = e => {\n    var _e$target$files;\n    const file = (_e$target$files = e.target.files) === null || _e$target$files === void 0 ? void 0 : _e$target$files[0];\n    if (file && onUpload) onUpload(product, file);\n    e.target.value = '';\n  };\n  const toast = useToast();\n  const handleAddToCart = async () => {\n    const token = localStorage.getItem('jwtToken');\n    if (!token) {\n      requireAuth();\n      return;\n    }\n    try {\n      await addToCart(productId, 1);\n      toast.success('Добавлено в корзину');\n    } catch (e) {\n      toast.error(e.message || 'Не удалось добавить в корзину');\n    }\n  };\n  const handleSetMain = async () => {\n    if (!imageId || !onSetMainAttachment) return;\n    try {\n      await onSetMainAttachment(product, imageId);\n      setAttachmentIds(prev => [imageId, ...prev.filter(id => id !== imageId)]);\n      setCurrentIdx(0);\n    } catch {}\n  };\n  const handleDelete = async () => {\n    if (!imageId || !onDeleteAttachment) return;\n    try {\n      await onDeleteAttachment(product, imageId);\n      setAttachmentIds(prev => prev.filter(id => id !== imageId));\n      setCurrentIdx(i => Math.max(0, Math.min(i, attachmentIds.length - 2)));\n    } catch {}\n  };\n  const [ratingLoadedOnce, setRatingLoadedOnce] = useState(false);\n  const loadRating = useCallback(async () => {\n    if (!productId) return;\n    try {\n      var _ref7, _r$avg, _ref8, _r$cnt;\n      setRatingLoading(true);\n      const r = await getProductRating(productId);\n      const newAvg = Number((_ref7 = (_r$avg = r === null || r === void 0 ? void 0 : r.avg) !== null && _r$avg !== void 0 ? _r$avg : r === null || r === void 0 ? void 0 : r.average) !== null && _ref7 !== void 0 ? _ref7 : 0);\n      const newCnt = Number((_ref8 = (_r$cnt = r === null || r === void 0 ? void 0 : r.cnt) !== null && _r$cnt !== void 0 ? _r$cnt : r === null || r === void 0 ? void 0 : r.count) !== null && _ref8 !== void 0 ? _ref8 : 0);\n      if (Number.isFinite(newAvg)) setAvg(newAvg);\n      if (Number.isFinite(newCnt)) setCount(newCnt);\n      setRatingLoadedOnce(true);\n    } catch {} finally {\n      setRatingLoading(false);\n    }\n  }, [productId]);\n  useEffect(() => {\n    if (inView && !ratingLoadedOnce) {\n      loadRating();\n    }\n  }, [inView, ratingLoadedOnce, loadRating]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: hostRef,\n    className: \"group relative bg-white rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-500 overflow-hidden border border-gray-200/50 hover:border-blue-200\",\n    children: [product.stock <= 5 && product.stock > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"absolute top-3 left-3 z-30\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative px-3 py-1.5 rounded-full font-semibold text-xs shadow-lg overflow-hidden\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute inset-0 bg-gradient-to-r from-orange-500 to-amber-500\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute inset-0 bg-gradient-to-r from-white/10 to-white/0\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"relative z-10 text-white font-bold\",\n          children: [\"\\u041E\\u0441\\u0442\\u0430\\u043B\\u043E\\u0441\\u044C \", product.stock]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute -top-1 -right-1 w-3 h-3 bg-yellow-400 rounded-full animate-pulse\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 17\n    }, this), product.stock === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"absolute top-3 left-3 z-30\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative px-3 py-1.5 rounded-full font-semibold text-xs shadow-lg overflow-hidden\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute inset-0 bg-gradient-to-r from-gray-600 to-gray-700\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"relative z-10 text-white font-bold\",\n          children: \"\\u041D\\u0435\\u0442 \\u0432 \\u043D\\u0430\\u043B\\u0438\\u0447\\u0438\\u0438\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 225,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 17\n    }, this), product.category && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"absolute top-3 right-3 z-30\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative px-3 py-1.5 rounded-full bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-100\",\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-xs font-medium text-blue-600\",\n          children: product.category\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"relative aspect-square overflow-hidden bg-gradient-to-br from-gray-50 to-blue-50 cursor-pointer\",\n      onClick: openDetails,\n      children: imgSrc ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: imgSrc,\n          alt: product.title,\n          className: \"w-full h-full object-cover transition-all duration-700 group-hover:scale-110\",\n          draggable: false,\n          loading: \"lazy\",\n          onError: e => {\n            e.currentTarget.src = '';\n            e.currentTarget.alt = 'Изображение недоступно';\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute inset-0 bg-gradient-to-t from-black/20 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 25\n        }, this), hasCarousel && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            \"data-role\": \"gallery-control\",\n            onClick: goPrev,\n            className: \"absolute top-0 left-0 h-full w-1/3 z-10 cursor-pointer\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 263,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            \"data-role\": \"gallery-control\",\n            onClick: goNext,\n            className: \"absolute top-0 right-0 h-full w-1/3 z-10 cursor-pointer\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 268,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            \"data-role\": \"gallery-control\",\n            onClick: goPrev,\n            className: \"absolute top-1/2 -translate-y-1/2 left-3 opacity-0 group-hover:opacity-100 transition-all duration-300 z-20 bg-white/90 hover:bg-white rounded-full p-2 shadow-lg backdrop-blur-sm\",\n            \"aria-label\": \"\\u041D\\u0430\\u0437\\u0430\\u0434\",\n            children: /*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"w-5 h-5 text-gray-800\",\n              fill: \"none\",\n              stroke: \"currentColor\",\n              viewBox: \"0 0 24 24\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: 2,\n                d: \"M15 19l-7-7 7-7\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 282,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 281,\n              columnNumber: 37\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 274,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            \"data-role\": \"gallery-control\",\n            onClick: goNext,\n            className: \"absolute top-1/2 -translate-y-1/2 right-3 opacity-0 group-hover:opacity-100 transition-all duration-300 z-20 bg-white/90 hover:bg-white rounded-full p-2 shadow-lg backdrop-blur-sm\",\n            \"aria-label\": \"\\u0412\\u043F\\u0435\\u0440\\u0451\\u0434\",\n            children: /*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"w-5 h-5 text-gray-800\",\n              fill: \"none\",\n              stroke: \"currentColor\",\n              viewBox: \"0 0 24 24\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: 2,\n                d: \"M9 5l7 7-7 7\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 294,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 293,\n              columnNumber: 37\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 286,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"absolute bottom-3 left-0 right-0 flex justify-center gap-1.5 z-20\",\n            children: attachmentIds.map((_, i) => /*#__PURE__*/_jsxDEV(\"span\", {\n              \"data-role\": \"gallery-control\",\n              onClick: e => {\n                e.stopPropagation();\n                setCurrentIdx(i);\n              },\n              className: `h-1.5 rounded-full cursor-pointer transition-all duration-300 ${i === currentIdx ? 'w-6 bg-gradient-to-r from-blue-500 to-purple-500 shadow' : 'w-2 bg-white/60 hover:bg-white/80'}`\n            }, i, false, {\n              fileName: _jsxFileName,\n              lineNumber: 300,\n              columnNumber: 41\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 298,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true), showUpload && imageId && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute top-3 right-12 z-30 flex flex-col gap-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: handleSetMain,\n            title: \"\\u0421\\u0434\\u0435\\u043B\\u0430\\u0442\\u044C \\u043F\\u0440\\u0435\\u0432\\u044C\\u044E\",\n            className: \"bg-white/90 hover:bg-white backdrop-blur-sm text-amber-600 rounded-full p-2 shadow-lg hover:shadow-xl transition-all duration-300\",\n            children: /*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"w-5 h-5\",\n              fill: \"currentColor\",\n              viewBox: \"0 0 20 20\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                d: \"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 324,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 323,\n              columnNumber: 37\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 317,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: handleDelete,\n            title: \"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u0444\\u043E\\u0442\\u043E\",\n            className: \"bg-white/90 hover:bg-white backdrop-blur-sm text-red-600 rounded-full p-2 shadow-lg hover:shadow-xl transition-all duration-300\",\n            children: /*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"w-5 h-5\",\n              fill: \"none\",\n              stroke: \"currentColor\",\n              viewBox: \"0 0 24 24\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: 2,\n                d: \"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 335,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 334,\n              columnNumber: 37\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 328,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 316,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full h-full flex flex-col items-center justify-center text-gray-400\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-16 h-16 mb-3 rounded-full bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center\",\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            className: \"w-8 h-8\",\n            fill: \"none\",\n            stroke: \"currentColor\",\n            viewBox: \"0 0 24 24\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\",\n              strokeWidth: 1.5,\n              d: \"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 345,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 344,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 343,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-sm font-medium text-gray-500\",\n          children: \"\\u041D\\u0435\\u0442 \\u0438\\u0437\\u043E\\u0431\\u0440\\u0430\\u0436\\u0435\\u043D\\u0438\\u044F\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 348,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 342,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-5\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"font-bold text-gray-900 text-lg mb-2 leading-tight group-hover:text-blue-600 transition-colors duration-300\",\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          to: `/product/${productId}`,\n          className: \"hover:underline\",\n          children: product.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 357,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 356,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-600 text-sm mb-4 line-clamp-2 leading-relaxed\",\n        children: product.description\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 363,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center mb-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center mr-3\",\n          children: [/*#__PURE__*/_jsxDEV(StarRating, {\n            rating: avg,\n            size: \"sm\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 370,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-sm font-bold text-gray-800 ml-2\",\n            children: avg.toFixed(1)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 371,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 369,\n          columnNumber: 21\n        }, this), ratingLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin mr-2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 375,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-xs text-gray-400\",\n            children: \"\\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 376,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 374,\n          columnNumber: 25\n        }, this) : count > 0 ? /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-sm text-gray-500 font-medium\",\n          children: [\"(\", count, \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 379,\n          columnNumber: 25\n        }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-sm text-gray-400\",\n          children: \"\\u041D\\u0435\\u0442 \\u043E\\u0442\\u0437\\u044B\\u0432\\u043E\\u0432\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 381,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 368,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `flex items-center ${showBuy ? 'justify-between' : 'justify-start'} mb-4`,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-col\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent\",\n            children: formatPrice(product.price)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 388,\n            columnNumber: 25\n          }, this), product.oldPrice && /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-sm text-gray-400 line-through\",\n            children: formatPrice(product.oldPrice)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 392,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 387,\n          columnNumber: 21\n        }, this), showBuy && isUser && /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleAddToCart,\n          className: \"relative px-5 py-2.5 rounded-xl font-medium transition-all duration-300 group overflow-hidden active:scale-95\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"absolute inset-0 bg-gradient-to-r from-blue-500 to-purple-600 group-hover:from-blue-600 group-hover:to-purple-700\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 401,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"absolute inset-0 bg-gradient-to-r from-white/0 via-white/5 to-white/0 translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-1000\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 402,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"relative z-10 flex items-center space-x-2 text-white font-semibold\",\n            children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"w-5 h-5\",\n              fill: \"none\",\n              stroke: \"currentColor\",\n              viewBox: \"0 0 24 24\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: 2,\n                d: \"M12 6v6m0 0v6m0-6h6m-6 0H6\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 405,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 404,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"\\u0412 \\u043A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0443\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 407,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 403,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 397,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 386,\n        columnNumber: 17\n      }, this), (canManage || showUpload) && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"pt-4 border-t border-gray-100\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-wrap gap-2\",\n          children: [canManage && /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => onEdit && onEdit(product),\n            className: \"relative px-4 py-2 rounded-lg font-medium transition-all duration-300 group overflow-hidden\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute inset-0 bg-gradient-to-r from-emerald-50 to-green-50 group-hover:from-emerald-100 group-hover:to-green-100\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 422,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute inset-0 border border-emerald-200 rounded-lg group-hover:border-emerald-300\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 423,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"relative z-10 flex items-center space-x-2 text-emerald-700 font-medium\",\n              children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                className: \"w-4 h-4\",\n                fill: \"none\",\n                stroke: \"currentColor\",\n                viewBox: \"0 0 24 24\",\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  strokeLinecap: \"round\",\n                  strokeLinejoin: \"round\",\n                  strokeWidth: 2,\n                  d: \"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 426,\n                  columnNumber: 45\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 425,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 428,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 424,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 418,\n            columnNumber: 33\n          }, this), canManage && onOpenStock && /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => onOpenStock(product),\n            className: \"relative px-4 py-2 rounded-lg font-medium transition-all duration-300 group overflow-hidden\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute inset-0 bg-gradient-to-r from-violet-50 to-indigo-50 group-hover:from-violet-100 group-hover:to-indigo-100\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 438,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute inset-0 border border-violet-200 rounded-lg group-hover:border-violet-300\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 439,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"relative z-10 flex items-center space-x-2 text-violet-700 font-medium\",\n              children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                className: \"w-4 h-4\",\n                fill: \"none\",\n                stroke: \"currentColor\",\n                viewBox: \"0 0 24 24\",\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  strokeLinecap: \"round\",\n                  strokeLinejoin: \"round\",\n                  strokeWidth: 2,\n                  d: \"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 442,\n                  columnNumber: 45\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 441,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"\\u0421\\u043A\\u043B\\u0430\\u0434\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 444,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 440,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 434,\n            columnNumber: 33\n          }, this), showUpload && /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              id: uploadInputId,\n              type: \"file\",\n              accept: \"image/*\",\n              className: \"hidden\",\n              onChange: handleFileChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 451,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: uploadInputId,\n              className: \"relative px-4 py-2 rounded-lg font-medium transition-all duration-300 group overflow-hidden cursor-pointer\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"absolute inset-0 bg-gradient-to-r from-gray-50 to-blue-50 group-hover:from-gray-100 group-hover:to-blue-100\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 456,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"absolute inset-0 border border-gray-200 rounded-lg group-hover:border-gray-300\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 457,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"relative z-10 flex items-center space-x-2 text-gray-700 font-medium\",\n                children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                  className: \"w-4 h-4\",\n                  fill: \"none\",\n                  stroke: \"currentColor\",\n                  viewBox: \"0 0 24 24\",\n                  children: /*#__PURE__*/_jsxDEV(\"path\", {\n                    strokeLinecap: \"round\",\n                    strokeLinejoin: \"round\",\n                    strokeWidth: 2,\n                    d: \"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 460,\n                    columnNumber: 49\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 459,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u0444\\u043E\\u0442\\u043E\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 462,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 458,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 452,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 416,\n          columnNumber: 25\n        }, this), canManage && stockInfo && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-3 pt-3 border-t border-gray-100\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid grid-cols-2 gap-2 text-xs\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex flex-col p-2 rounded-lg bg-gradient-to-r from-blue-50 to-indigo-50\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-gray-600 mb-1\",\n                children: \"\\u041D\\u0430 \\u0441\\u043A\\u043B\\u0430\\u0434\\u0435\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 474,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"font-bold text-gray-900 text-sm\",\n                children: [stockInfo.available, \" \\u0448\\u0442.\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 475,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 473,\n              columnNumber: 37\n            }, this), typeof stockInfo.quantityReserved === 'number' && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex flex-col p-2 rounded-lg bg-gradient-to-r from-amber-50 to-orange-50\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-gray-600 mb-1\",\n                children: \"\\u0412 \\u0440\\u0435\\u0437\\u0435\\u0440\\u0432\\u0435\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 479,\n                columnNumber: 45\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"font-bold text-amber-700 text-sm\",\n                children: [stockInfo.quantityReserved, \" \\u0448\\u0442.\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 480,\n                columnNumber: 45\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 478,\n              columnNumber: 41\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 472,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 471,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 415,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 354,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"h-1 bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 opacity-0 group-hover:opacity-100 transition-opacity duration-500\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 491,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 209,\n    columnNumber: 9\n  }, this);\n};\n_s2(ProductCard, \"oa5w7YcV5CNj801CgBFPycuvOKI=\", false, function () {\n  return [useNavigate, useInViewportOnce, useToast];\n});\n_c = ProductCard;\nexport default ProductCard;\nvar _c;\n$RefreshReg$(_c, \"ProductCard\");","map":{"version":3,"names":["React","useCallback","useEffect","useMemo","useRef","useState","StarRating","formatPrice","getProductRating","addToCart","useNavigate","Link","useToast","getRolesFromToken","jsxDEV","_jsxDEV","Fragment","_Fragment","PRODUCTS_API","process","env","REACT_APP_PRODUCTS_URL","extractAttachmentIds","p","Array","isArray","attachments","length","map","a","gridFsId","id","filter","Boolean","mainAttachmentId","getRatingValue","_ref","_ref2","_ref3","_p$rating","v","rating","ratingAverage","avgRating","averageRating","n","Number","isFinite","getRatingCount","_ref4","_ref5","_ref6","_p$ratingCount","c","ratingCount","reviewsCount","reviewCount","ratingsCount","useInViewportOnce","threshold","_s","ref","visible","setVisible","el","current","obs","IntersectionObserver","entry","isIntersecting","disconnect","observe","ProductCard","product","canManage","onEdit","showBuy","showUpload","onUpload","onRequireAuth","onSetMainAttachment","onDeleteAttachment","stockInfo","onOpenStock","_s2","requireAuth","alert","initialAvg","initialCnt","avg","setAvg","count","setCount","ratingLoading","setRatingLoading","token","localStorage","getItem","roles","isUser","includes","productId","productUUID","navigate","openDetails","e","target","closest","initialIds","attachmentIds","setAttachmentIds","fetchedAll","setFetchedAll","currentIdx","setCurrentIdx","hostRef","inView","imageId","imgSrc","fetchAllIds","res","fetch","ok","list","json","ids","i","Math","min","cancelled","goPrev","_e$stopPropagation","stopPropagation","call","goNext","_e$stopPropagation2","hasCarousel","uploadInputId","handleFileChange","_e$target$files","file","files","value","toast","handleAddToCart","success","error","message","handleSetMain","prev","handleDelete","max","ratingLoadedOnce","setRatingLoadedOnce","loadRating","_ref7","_r$avg","_ref8","_r$cnt","r","newAvg","average","newCnt","cnt","className","children","stock","fileName","_jsxFileName","lineNumber","columnNumber","category","onClick","src","alt","title","draggable","loading","onError","currentTarget","type","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","_","to","description","size","toFixed","price","oldPrice","accept","onChange","htmlFor","available","quantityReserved","_c","$RefreshReg$"],"sources":["C:/Users/User/Documents/GitHub/Market/src/components/Productservice/ProductCard.jsx"],"sourcesContent":["import React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\r\nimport StarRating from '../Shared/StarRating';\r\nimport { formatPrice } from '../../utils/format';\r\nimport { getProductRating } from '../../services/reviews';\r\nimport { addToCart } from '../../services/cart';\r\nimport { useNavigate, Link } from 'react-router-dom';\r\nimport { useToast } from '../Shared/ToastProvider';\r\nimport { getRolesFromToken } from '../../utils/jwt';\r\n\r\nconst PRODUCTS_API =\r\n    process.env.REACT_APP_PRODUCTS_URL ||\r\n    'http://localhost:8072/productservice/api/v1';\r\n\r\nconst extractAttachmentIds = (p) => {\r\n    if (Array.isArray(p?.attachments) && p.attachments.length) {\r\n        return p.attachments.map((a) => a?.gridFsId || a?.id || a).filter(Boolean);\r\n    }\r\n    if (p?.mainAttachmentId) return [p.mainAttachmentId];\r\n    return [];\r\n};\r\n\r\nconst getRatingValue = (p) => {\r\n    const v = p?.rating ?? p?.ratingAverage ?? p?.avgRating ?? p?.averageRating ?? 0;\r\n    const n = Number(v);\r\n    return Number.isFinite(n) ? n : 0;\r\n};\r\nconst getRatingCount = (p) => {\r\n    const c = p?.ratingCount ?? p?.reviewsCount ?? p?.reviewCount ?? p?.ratingsCount ?? 0;\r\n    const n = Number(c);\r\n    return Number.isFinite(n) ? n : 0;\r\n};\r\n\r\nconst useInViewportOnce = (threshold = 0.2) => {\r\n    const ref = useRef(null);\r\n    const [visible, setVisible] = useState(false);\r\n    useEffect(() => {\r\n        const el = ref.current;\r\n        if (!el || visible) return;\r\n        const obs = new IntersectionObserver(\r\n            ([entry]) => {\r\n                if (entry.isIntersecting) {\r\n                    setVisible(true);\r\n                    obs.disconnect();\r\n                }\r\n            },\r\n            { threshold }\r\n        );\r\n        obs.observe(el);\r\n        return () => obs.disconnect();\r\n    }, [visible]);\r\n    return [ref, visible];\r\n};\r\n\r\nconst ProductCard = ({\r\n    product,\r\n    canManage,\r\n    onEdit,\r\n    showBuy = true,\r\n    showUpload = false,\r\n    onUpload,\r\n    onRequireAuth,\r\n    onSetMainAttachment,\r\n    onDeleteAttachment,\r\n    stockInfo,\r\n    onOpenStock\r\n}) => {\r\n    const requireAuth = typeof onRequireAuth === 'function' ? onRequireAuth : () => alert('Нужно войти');\r\n\r\n    const initialAvg = getRatingValue(product);\r\n    const initialCnt = getRatingCount(product);\r\n\r\n    const [avg, setAvg] = useState(initialAvg);\r\n    const [count, setCount] = useState(initialCnt);\r\n    const [ratingLoading, setRatingLoading] = useState(false);\r\n\r\n    const token = useMemo(() => localStorage.getItem('jwtToken'), []);\r\n    const roles = useMemo(() => (token ? getRolesFromToken(token) : []), [token]);\r\n    const isUser = roles.includes('USER') || roles.includes('ROLE_USER');\r\n\r\n    const productId = useMemo(() => product.productUUID || product.id, [product]);\r\n    const navigate = useNavigate();\r\n\r\n    const openDetails = (e) => {\r\n        if (e.target.closest('[data-role=\"gallery-control\"]')) return;\r\n        if (!productId) return;\r\n        navigate(`/product/${productId}`);\r\n    };\r\n\r\n    const initialIds = useMemo(() => extractAttachmentIds(product), [product]);\r\n    const [attachmentIds, setAttachmentIds] = useState(initialIds);\r\n    const [fetchedAll, setFetchedAll] = useState(Array.isArray(product?.attachments) && product.attachments.length > 0);\r\n    const [currentIdx, setCurrentIdx] = useState(0);\r\n\r\n    const [hostRef, inView] = useInViewportOnce(0.2);\r\n    const imageId = attachmentIds[currentIdx];\r\n    const imgSrc = inView && imageId ? `${PRODUCTS_API}/products/${imageId}/attachments-fs` : null;\r\n\r\n    const fetchAllIds = useCallback(async () => {\r\n        if (fetchedAll || !productId) return false;\r\n        try {\r\n            const res = await fetch(`${PRODUCTS_API}/products/${productId}/attachments`);\r\n            if (!res.ok) return false;\r\n            const list = await res.json();\r\n            const ids = Array.isArray(list) ? list.map(a => a?.gridFsId || a?.id).filter(Boolean) : [];\r\n            if (ids.length) {\r\n                setAttachmentIds(ids);\r\n                setFetchedAll(true);\r\n                setCurrentIdx(i => Math.min(i, ids.length - 1));\r\n                return true;\r\n            }\r\n        } catch { }\r\n        return false;\r\n    }, [fetchedAll, productId]);\r\n\r\n    useEffect(() => {\r\n        let cancelled = false;\r\n        (async () => {\r\n            if (!inView) return;\r\n            if (attachmentIds.length > 0) return;\r\n            const ok = await fetchAllIds();\r\n            if (!cancelled && !ok) { }\r\n        })();\r\n        return () => { cancelled = true; };\r\n    }, [inView, attachmentIds.length, fetchAllIds]);\r\n\r\n    const goPrev = useCallback(async (e) => {\r\n        e?.stopPropagation?.();\r\n        if (!fetchedAll && attachmentIds.length <= 1) {\r\n            const ok = await fetchAllIds();\r\n            if (!ok || attachmentIds.length <= 1) return;\r\n        }\r\n        setCurrentIdx(i => (i - 1 + attachmentIds.length) % attachmentIds.length);\r\n    }, [fetchedAll, attachmentIds.length, fetchAllIds]);\r\n\r\n    const goNext = useCallback(async (e) => {\r\n        e?.stopPropagation?.();\r\n        if (!fetchedAll && attachmentIds.length <= 1) {\r\n            const ok = await fetchAllIds();\r\n            if (!ok || attachmentIds.length <= 1) return;\r\n        }\r\n        setCurrentIdx(i => (i + 1) % attachmentIds.length);\r\n    }, [fetchedAll, attachmentIds.length, fetchAllIds]);\r\n\r\n    const hasCarousel = attachmentIds.length > 1;\r\n\r\n    const uploadInputId = `upload-${productId}`;\r\n    const handleFileChange = (e) => {\r\n        const file = e.target.files?.[0];\r\n        if (file && onUpload) onUpload(product, file);\r\n        e.target.value = '';\r\n    };\r\n\r\n    const toast = useToast();\r\n\r\n    const handleAddToCart = async () => {\r\n        const token = localStorage.getItem('jwtToken');\r\n        if (!token) { requireAuth(); return; }\r\n        try {\r\n            await addToCart(productId, 1);\r\n            toast.success('Добавлено в корзину');\r\n        } catch (e) {\r\n            toast.error(e.message || 'Не удалось добавить в корзину');\r\n        }\r\n    };\r\n\r\n    const handleSetMain = async () => {\r\n        if (!imageId || !onSetMainAttachment) return;\r\n        try {\r\n            await onSetMainAttachment(product, imageId);\r\n            setAttachmentIds(prev => [imageId, ...prev.filter(id => id !== imageId)]);\r\n            setCurrentIdx(0);\r\n        } catch { }\r\n    };\r\n\r\n    const handleDelete = async () => {\r\n        if (!imageId || !onDeleteAttachment) return;\r\n        try {\r\n            await onDeleteAttachment(product, imageId);\r\n            setAttachmentIds(prev => prev.filter(id => id !== imageId));\r\n            setCurrentIdx(i => Math.max(0, Math.min(i, attachmentIds.length - 2)));\r\n        } catch { }\r\n    };\r\n\r\n    const [ratingLoadedOnce, setRatingLoadedOnce] = useState(false);\r\n\r\n    const loadRating = useCallback(async () => {\r\n        if (!productId) return;\r\n        try {\r\n            setRatingLoading(true);\r\n            const r = await getProductRating(productId);\r\n            const newAvg = Number(r?.avg ?? r?.average ?? 0);\r\n            const newCnt = Number(r?.cnt ?? r?.count ?? 0);\r\n            if (Number.isFinite(newAvg)) setAvg(newAvg);\r\n            if (Number.isFinite(newCnt)) setCount(newCnt);\r\n            setRatingLoadedOnce(true);\r\n        } catch {\r\n        } finally {\r\n            setRatingLoading(false);\r\n        }\r\n    }, [productId]);\r\n\r\n    useEffect(() => {\r\n        if (inView && !ratingLoadedOnce) {\r\n            loadRating();\r\n        }\r\n    }, [inView, ratingLoadedOnce, loadRating]);\r\n\r\n    return (\r\n        <div ref={hostRef} className=\"group relative bg-white rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-500 overflow-hidden border border-gray-200/50 hover:border-blue-200\">\r\n            {/* Акционные метки в стиле хедера */}\r\n            {product.stock <= 5 && product.stock > 0 && (\r\n                <div className=\"absolute top-3 left-3 z-30\">\r\n                    <div className=\"relative px-3 py-1.5 rounded-full font-semibold text-xs shadow-lg overflow-hidden\">\r\n                        <div className=\"absolute inset-0 bg-gradient-to-r from-orange-500 to-amber-500\"></div>\r\n                        <div className=\"absolute inset-0 bg-gradient-to-r from-white/10 to-white/0\"></div>\r\n                        <span className=\"relative z-10 text-white font-bold\">Осталось {product.stock}</span>\r\n                        <div className=\"absolute -top-1 -right-1 w-3 h-3 bg-yellow-400 rounded-full animate-pulse\"></div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n            {product.stock === 0 && (\r\n                <div className=\"absolute top-3 left-3 z-30\">\r\n                    <div className=\"relative px-3 py-1.5 rounded-full font-semibold text-xs shadow-lg overflow-hidden\">\r\n                        <div className=\"absolute inset-0 bg-gradient-to-r from-gray-600 to-gray-700\"></div>\r\n                        <span className=\"relative z-10 text-white font-bold\">Нет в наличии</span>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Category badge */}\r\n            {product.category && (\r\n                <div className=\"absolute top-3 right-3 z-30\">\r\n                    <div className=\"relative px-3 py-1.5 rounded-full bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-100\">\r\n                        <span className=\"text-xs font-medium text-blue-600\">{product.category}</span>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Image Container */}\r\n            <div\r\n                className=\"relative aspect-square overflow-hidden bg-gradient-to-br from-gray-50 to-blue-50 cursor-pointer\"\r\n                onClick={openDetails}\r\n            >\r\n                {imgSrc ? (\r\n                    <>\r\n                        <img\r\n                            src={imgSrc}\r\n                            alt={product.title}\r\n                            className=\"w-full h-full object-cover transition-all duration-700 group-hover:scale-110\"\r\n                            draggable={false}\r\n                            loading=\"lazy\"\r\n                            onError={(e) => {\r\n                                e.currentTarget.src = '';\r\n                                e.currentTarget.alt = 'Изображение недоступно';\r\n                            }}\r\n                        />\r\n\r\n                        {/* Overlay gradient on hover */}\r\n                        <div className=\"absolute inset-0 bg-gradient-to-t from-black/20 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300\"></div>\r\n\r\n                        {hasCarousel && (\r\n                            <>\r\n                                <div\r\n                                    data-role=\"gallery-control\"\r\n                                    onClick={goPrev}\r\n                                    className=\"absolute top-0 left-0 h-full w-1/3 z-10 cursor-pointer\"\r\n                                />\r\n                                <div\r\n                                    data-role=\"gallery-control\"\r\n                                    onClick={goNext}\r\n                                    className=\"absolute top-0 right-0 h-full w-1/3 z-10 cursor-pointer\"\r\n                                />\r\n\r\n                                <button\r\n                                    type=\"button\"\r\n                                    data-role=\"gallery-control\"\r\n                                    onClick={goPrev}\r\n                                    className=\"absolute top-1/2 -translate-y-1/2 left-3 opacity-0 group-hover:opacity-100 transition-all duration-300 z-20 bg-white/90 hover:bg-white rounded-full p-2 shadow-lg backdrop-blur-sm\"\r\n                                    aria-label=\"Назад\"\r\n                                >\r\n                                    <svg className=\"w-5 h-5 text-gray-800\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\r\n                                    </svg>\r\n                                </button>\r\n\r\n                                <button\r\n                                    type=\"button\"\r\n                                    data-role=\"gallery-control\"\r\n                                    onClick={goNext}\r\n                                    className=\"absolute top-1/2 -translate-y-1/2 right-3 opacity-0 group-hover:opacity-100 transition-all duration-300 z-20 bg-white/90 hover:bg-white rounded-full p-2 shadow-lg backdrop-blur-sm\"\r\n                                    aria-label=\"Вперёд\"\r\n                                >\r\n                                    <svg className=\"w-5 h-5 text-gray-800\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" />\r\n                                    </svg>\r\n                                </button>\r\n\r\n                                <div className=\"absolute bottom-3 left-0 right-0 flex justify-center gap-1.5 z-20\">\r\n                                    {attachmentIds.map((_, i) => (\r\n                                        <span\r\n                                            key={i}\r\n                                            data-role=\"gallery-control\"\r\n                                            onClick={(e) => { e.stopPropagation(); setCurrentIdx(i); }}\r\n                                            className={`h-1.5 rounded-full cursor-pointer transition-all duration-300 ${\r\n                                                i === currentIdx\r\n                                                    ? 'w-6 bg-gradient-to-r from-blue-500 to-purple-500 shadow'\r\n                                                    : 'w-2 bg-white/60 hover:bg-white/80'\r\n                                            }`}\r\n                                        />\r\n                                    ))}\r\n                                </div>\r\n                            </>\r\n                        )}\r\n\r\n                        {showUpload && imageId && (\r\n                            <div className=\"absolute top-3 right-12 z-30 flex flex-col gap-2\">\r\n                                <button\r\n                                    type=\"button\"\r\n                                    onClick={handleSetMain}\r\n                                    title=\"Сделать превью\"\r\n                                    className=\"bg-white/90 hover:bg-white backdrop-blur-sm text-amber-600 rounded-full p-2 shadow-lg hover:shadow-xl transition-all duration-300\"\r\n                                >\r\n                                    <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                                        <path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\" />\r\n                                    </svg>\r\n                                </button>\r\n\r\n                                <button\r\n                                    type=\"button\"\r\n                                    onClick={handleDelete}\r\n                                    title=\"Удалить фото\"\r\n                                    className=\"bg-white/90 hover:bg-white backdrop-blur-sm text-red-600 rounded-full p-2 shadow-lg hover:shadow-xl transition-all duration-300\"\r\n                                >\r\n                                    <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\r\n                                    </svg>\r\n                                </button>\r\n                            </div>\r\n                        )}\r\n                    </>\r\n                ) : (\r\n                    <div className=\"w-full h-full flex flex-col items-center justify-center text-gray-400\">\r\n                        <div className=\"w-16 h-16 mb-3 rounded-full bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center\">\r\n                            <svg className=\"w-8 h-8\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\" />\r\n                            </svg>\r\n                        </div>\r\n                        <span className=\"text-sm font-medium text-gray-500\">Нет изображения</span>\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Content */}\r\n            <div className=\"p-5\">\r\n                {/* Title */}\r\n                <h3 className=\"font-bold text-gray-900 text-lg mb-2 leading-tight group-hover:text-blue-600 transition-colors duration-300\">\r\n                    <Link to={`/product/${productId}`} className=\"hover:underline\">\r\n                        {product.title}\r\n                    </Link>\r\n                </h3>\r\n\r\n                {/* Description */}\r\n                <p className=\"text-gray-600 text-sm mb-4 line-clamp-2 leading-relaxed\">\r\n                    {product.description}\r\n                </p>\r\n\r\n                {/* Rating */}\r\n                <div className=\"flex items-center mb-4\">\r\n                    <div className=\"flex items-center mr-3\">\r\n                        <StarRating rating={avg} size=\"sm\" />\r\n                        <span className=\"text-sm font-bold text-gray-800 ml-2\">{avg.toFixed(1)}</span>\r\n                    </div>\r\n                    {ratingLoading ? (\r\n                        <div className=\"flex items-center\">\r\n                            <div className=\"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin mr-2\"></div>\r\n                            <span className=\"text-xs text-gray-400\">загрузка...</span>\r\n                        </div>\r\n                    ) : count > 0 ? (\r\n                        <span className=\"text-sm text-gray-500 font-medium\">({count})</span>\r\n                    ) : (\r\n                        <span className=\"text-sm text-gray-400\">Нет отзывов</span>\r\n                    )}\r\n                </div>\r\n\r\n                {/* Price and Add to Cart */}\r\n                <div className={`flex items-center ${showBuy ? 'justify-between' : 'justify-start'} mb-4`}>\r\n                    <div className=\"flex flex-col\">\r\n                        <span className=\"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent\">\r\n                            {formatPrice(product.price)}\r\n                        </span>\r\n                        {product.oldPrice && (\r\n                            <span className=\"text-sm text-gray-400 line-through\">{formatPrice(product.oldPrice)}</span>\r\n                        )}\r\n                    </div>\r\n\r\n                    {showBuy && isUser && (\r\n                        <button\r\n                            onClick={handleAddToCart}\r\n                            className=\"relative px-5 py-2.5 rounded-xl font-medium transition-all duration-300 group overflow-hidden active:scale-95\"\r\n                        >\r\n                            <div className=\"absolute inset-0 bg-gradient-to-r from-blue-500 to-purple-600 group-hover:from-blue-600 group-hover:to-purple-700\"></div>\r\n                            <div className=\"absolute inset-0 bg-gradient-to-r from-white/0 via-white/5 to-white/0 translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-1000\"></div>\r\n                            <span className=\"relative z-10 flex items-center space-x-2 text-white font-semibold\">\r\n                                <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\" />\r\n                                </svg>\r\n                                <span>В корзину</span>\r\n                            </span>\r\n                        </button>\r\n                    )}\r\n                </div>\r\n\r\n                {/* Management Controls */}\r\n                {(canManage || showUpload) && (\r\n                    <div className=\"pt-4 border-t border-gray-100\">\r\n                        <div className=\"flex flex-wrap gap-2\">\r\n                            {canManage && (\r\n                                <button\r\n                                    onClick={() => onEdit && onEdit(product)}\r\n                                    className=\"relative px-4 py-2 rounded-lg font-medium transition-all duration-300 group overflow-hidden\"\r\n                                >\r\n                                    <div className=\"absolute inset-0 bg-gradient-to-r from-emerald-50 to-green-50 group-hover:from-emerald-100 group-hover:to-green-100\"></div>\r\n                                    <div className=\"absolute inset-0 border border-emerald-200 rounded-lg group-hover:border-emerald-300\"></div>\r\n                                    <span className=\"relative z-10 flex items-center space-x-2 text-emerald-700 font-medium\">\r\n                                        <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\" />\r\n                                        </svg>\r\n                                        <span>Редактировать</span>\r\n                                    </span>\r\n                                </button>\r\n                            )}\r\n\r\n                            {canManage && onOpenStock && (\r\n                                <button\r\n                                    onClick={() => onOpenStock(product)}\r\n                                    className=\"relative px-4 py-2 rounded-lg font-medium transition-all duration-300 group overflow-hidden\"\r\n                                >\r\n                                    <div className=\"absolute inset-0 bg-gradient-to-r from-violet-50 to-indigo-50 group-hover:from-violet-100 group-hover:to-indigo-100\"></div>\r\n                                    <div className=\"absolute inset-0 border border-violet-200 rounded-lg group-hover:border-violet-300\"></div>\r\n                                    <span className=\"relative z-10 flex items-center space-x-2 text-violet-700 font-medium\">\r\n                                        <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4\" />\r\n                                        </svg>\r\n                                        <span>Склад</span>\r\n                                    </span>\r\n                                </button>\r\n                            )}\r\n\r\n                            {showUpload && (\r\n                                <>\r\n                                    <input id={uploadInputId} type=\"file\" accept=\"image/*\" className=\"hidden\" onChange={handleFileChange} />\r\n                                    <label\r\n                                        htmlFor={uploadInputId}\r\n                                        className=\"relative px-4 py-2 rounded-lg font-medium transition-all duration-300 group overflow-hidden cursor-pointer\"\r\n                                    >\r\n                                        <div className=\"absolute inset-0 bg-gradient-to-r from-gray-50 to-blue-50 group-hover:from-gray-100 group-hover:to-blue-100\"></div>\r\n                                        <div className=\"absolute inset-0 border border-gray-200 rounded-lg group-hover:border-gray-300\"></div>\r\n                                        <span className=\"relative z-10 flex items-center space-x-2 text-gray-700 font-medium\">\r\n                                            <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12\" />\r\n                                            </svg>\r\n                                            <span>Загрузить фото</span>\r\n                                        </span>\r\n                                    </label>\r\n                                </>\r\n                            )}\r\n                        </div>\r\n\r\n                        {/* Stock Info for Admins */}\r\n                        {canManage && stockInfo && (\r\n                            <div className=\"mt-3 pt-3 border-t border-gray-100\">\r\n                                <div className=\"grid grid-cols-2 gap-2 text-xs\">\r\n                                    <div className=\"flex flex-col p-2 rounded-lg bg-gradient-to-r from-blue-50 to-indigo-50\">\r\n                                        <span className=\"text-gray-600 mb-1\">На складе</span>\r\n                                        <span className=\"font-bold text-gray-900 text-sm\">{stockInfo.available} шт.</span>\r\n                                    </div>\r\n                                    {typeof stockInfo.quantityReserved === 'number' && (\r\n                                        <div className=\"flex flex-col p-2 rounded-lg bg-gradient-to-r from-amber-50 to-orange-50\">\r\n                                            <span className=\"text-gray-600 mb-1\">В резерве</span>\r\n                                            <span className=\"font-bold text-amber-700 text-sm\">{stockInfo.quantityReserved} шт.</span>\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Bottom gradient line like in header */}\r\n            <div className=\"h-1 bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 opacity-0 group-hover:opacity-100 transition-opacity duration-500\"></div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ProductCard;"],"mappings":";;;AAAA,OAAOA,KAAK,IAAIC,WAAW,EAAEC,SAAS,EAAEC,OAAO,EAAEC,MAAM,EAAEC,QAAQ,QAAQ,OAAO;AAChF,OAAOC,UAAU,MAAM,sBAAsB;AAC7C,SAASC,WAAW,QAAQ,oBAAoB;AAChD,SAASC,gBAAgB,QAAQ,wBAAwB;AACzD,SAASC,SAAS,QAAQ,qBAAqB;AAC/C,SAASC,WAAW,EAAEC,IAAI,QAAQ,kBAAkB;AACpD,SAASC,QAAQ,QAAQ,yBAAyB;AAClD,SAASC,iBAAiB,QAAQ,iBAAiB;AAAC,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AAEpD,MAAMC,YAAY,GACdC,OAAO,CAACC,GAAG,CAACC,sBAAsB,IAClC,6CAA6C;AAEjD,MAAMC,oBAAoB,GAAIC,CAAC,IAAK;EAChC,IAAIC,KAAK,CAACC,OAAO,CAACF,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAEG,WAAW,CAAC,IAAIH,CAAC,CAACG,WAAW,CAACC,MAAM,EAAE;IACvD,OAAOJ,CAAC,CAACG,WAAW,CAACE,GAAG,CAAEC,CAAC,IAAK,CAAAA,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAEC,QAAQ,MAAID,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAEE,EAAE,KAAIF,CAAC,CAAC,CAACG,MAAM,CAACC,OAAO,CAAC;EAC9E;EACA,IAAIV,CAAC,aAADA,CAAC,eAADA,CAAC,CAAEW,gBAAgB,EAAE,OAAO,CAACX,CAAC,CAACW,gBAAgB,CAAC;EACpD,OAAO,EAAE;AACb,CAAC;AAED,MAAMC,cAAc,GAAIZ,CAAC,IAAK;EAAA,IAAAa,IAAA,EAAAC,KAAA,EAAAC,KAAA,EAAAC,SAAA;EAC1B,MAAMC,CAAC,IAAAJ,IAAA,IAAAC,KAAA,IAAAC,KAAA,IAAAC,SAAA,GAAGhB,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAEkB,MAAM,cAAAF,SAAA,cAAAA,SAAA,GAAIhB,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAEmB,aAAa,cAAAJ,KAAA,cAAAA,KAAA,GAAIf,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAEoB,SAAS,cAAAN,KAAA,cAAAA,KAAA,GAAId,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAEqB,aAAa,cAAAR,IAAA,cAAAA,IAAA,GAAI,CAAC;EAChF,MAAMS,CAAC,GAAGC,MAAM,CAACN,CAAC,CAAC;EACnB,OAAOM,MAAM,CAACC,QAAQ,CAACF,CAAC,CAAC,GAAGA,CAAC,GAAG,CAAC;AACrC,CAAC;AACD,MAAMG,cAAc,GAAIzB,CAAC,IAAK;EAAA,IAAA0B,KAAA,EAAAC,KAAA,EAAAC,KAAA,EAAAC,cAAA;EAC1B,MAAMC,CAAC,IAAAJ,KAAA,IAAAC,KAAA,IAAAC,KAAA,IAAAC,cAAA,GAAG7B,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAE+B,WAAW,cAAAF,cAAA,cAAAA,cAAA,GAAI7B,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAEgC,YAAY,cAAAJ,KAAA,cAAAA,KAAA,GAAI5B,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAEiC,WAAW,cAAAN,KAAA,cAAAA,KAAA,GAAI3B,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAEkC,YAAY,cAAAR,KAAA,cAAAA,KAAA,GAAI,CAAC;EACrF,MAAMJ,CAAC,GAAGC,MAAM,CAACO,CAAC,CAAC;EACnB,OAAOP,MAAM,CAACC,QAAQ,CAACF,CAAC,CAAC,GAAGA,CAAC,GAAG,CAAC;AACrC,CAAC;AAED,MAAMa,iBAAiB,GAAGA,CAACC,SAAS,GAAG,GAAG,KAAK;EAAAC,EAAA;EAC3C,MAAMC,GAAG,GAAGzD,MAAM,CAAC,IAAI,CAAC;EACxB,MAAM,CAAC0D,OAAO,EAAEC,UAAU,CAAC,GAAG1D,QAAQ,CAAC,KAAK,CAAC;EAC7CH,SAAS,CAAC,MAAM;IACZ,MAAM8D,EAAE,GAAGH,GAAG,CAACI,OAAO;IACtB,IAAI,CAACD,EAAE,IAAIF,OAAO,EAAE;IACpB,MAAMI,GAAG,GAAG,IAAIC,oBAAoB,CAChC,CAAC,CAACC,KAAK,CAAC,KAAK;MACT,IAAIA,KAAK,CAACC,cAAc,EAAE;QACtBN,UAAU,CAAC,IAAI,CAAC;QAChBG,GAAG,CAACI,UAAU,CAAC,CAAC;MACpB;IACJ,CAAC,EACD;MAAEX;IAAU,CAChB,CAAC;IACDO,GAAG,CAACK,OAAO,CAACP,EAAE,CAAC;IACf,OAAO,MAAME,GAAG,CAACI,UAAU,CAAC,CAAC;EACjC,CAAC,EAAE,CAACR,OAAO,CAAC,CAAC;EACb,OAAO,CAACD,GAAG,EAAEC,OAAO,CAAC;AACzB,CAAC;AAACF,EAAA,CAnBIF,iBAAiB;AAqBvB,MAAMc,WAAW,GAAGA,CAAC;EACjBC,OAAO;EACPC,SAAS;EACTC,MAAM;EACNC,OAAO,GAAG,IAAI;EACdC,UAAU,GAAG,KAAK;EAClBC,QAAQ;EACRC,aAAa;EACbC,mBAAmB;EACnBC,kBAAkB;EAClBC,SAAS;EACTC;AACJ,CAAC,KAAK;EAAAC,GAAA;EACF,MAAMC,WAAW,GAAG,OAAON,aAAa,KAAK,UAAU,GAAGA,aAAa,GAAG,MAAMO,KAAK,CAAC,aAAa,CAAC;EAEpG,MAAMC,UAAU,GAAGpD,cAAc,CAACsC,OAAO,CAAC;EAC1C,MAAMe,UAAU,GAAGxC,cAAc,CAACyB,OAAO,CAAC;EAE1C,MAAM,CAACgB,GAAG,EAAEC,MAAM,CAAC,GAAGrF,QAAQ,CAACkF,UAAU,CAAC;EAC1C,MAAM,CAACI,KAAK,EAAEC,QAAQ,CAAC,GAAGvF,QAAQ,CAACmF,UAAU,CAAC;EAC9C,MAAM,CAACK,aAAa,EAAEC,gBAAgB,CAAC,GAAGzF,QAAQ,CAAC,KAAK,CAAC;EAEzD,MAAM0F,KAAK,GAAG5F,OAAO,CAAC,MAAM6F,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC,EAAE,EAAE,CAAC;EACjE,MAAMC,KAAK,GAAG/F,OAAO,CAAC,MAAO4F,KAAK,GAAGlF,iBAAiB,CAACkF,KAAK,CAAC,GAAG,EAAG,EAAE,CAACA,KAAK,CAAC,CAAC;EAC7E,MAAMI,MAAM,GAAGD,KAAK,CAACE,QAAQ,CAAC,MAAM,CAAC,IAAIF,KAAK,CAACE,QAAQ,CAAC,WAAW,CAAC;EAEpE,MAAMC,SAAS,GAAGlG,OAAO,CAAC,MAAMsE,OAAO,CAAC6B,WAAW,IAAI7B,OAAO,CAAC1C,EAAE,EAAE,CAAC0C,OAAO,CAAC,CAAC;EAC7E,MAAM8B,QAAQ,GAAG7F,WAAW,CAAC,CAAC;EAE9B,MAAM8F,WAAW,GAAIC,CAAC,IAAK;IACvB,IAAIA,CAAC,CAACC,MAAM,CAACC,OAAO,CAAC,+BAA+B,CAAC,EAAE;IACvD,IAAI,CAACN,SAAS,EAAE;IAChBE,QAAQ,CAAC,YAAYF,SAAS,EAAE,CAAC;EACrC,CAAC;EAED,MAAMO,UAAU,GAAGzG,OAAO,CAAC,MAAMmB,oBAAoB,CAACmD,OAAO,CAAC,EAAE,CAACA,OAAO,CAAC,CAAC;EAC1E,MAAM,CAACoC,aAAa,EAAEC,gBAAgB,CAAC,GAAGzG,QAAQ,CAACuG,UAAU,CAAC;EAC9D,MAAM,CAACG,UAAU,EAAEC,aAAa,CAAC,GAAG3G,QAAQ,CAACmB,KAAK,CAACC,OAAO,CAACgD,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAE/C,WAAW,CAAC,IAAI+C,OAAO,CAAC/C,WAAW,CAACC,MAAM,GAAG,CAAC,CAAC;EACnH,MAAM,CAACsF,UAAU,EAAEC,aAAa,CAAC,GAAG7G,QAAQ,CAAC,CAAC,CAAC;EAE/C,MAAM,CAAC8G,OAAO,EAAEC,MAAM,CAAC,GAAG1D,iBAAiB,CAAC,GAAG,CAAC;EAChD,MAAM2D,OAAO,GAAGR,aAAa,CAACI,UAAU,CAAC;EACzC,MAAMK,MAAM,GAAGF,MAAM,IAAIC,OAAO,GAAG,GAAGnG,YAAY,aAAamG,OAAO,iBAAiB,GAAG,IAAI;EAE9F,MAAME,WAAW,GAAGtH,WAAW,CAAC,YAAY;IACxC,IAAI8G,UAAU,IAAI,CAACV,SAAS,EAAE,OAAO,KAAK;IAC1C,IAAI;MACA,MAAMmB,GAAG,GAAG,MAAMC,KAAK,CAAC,GAAGvG,YAAY,aAAamF,SAAS,cAAc,CAAC;MAC5E,IAAI,CAACmB,GAAG,CAACE,EAAE,EAAE,OAAO,KAAK;MACzB,MAAMC,IAAI,GAAG,MAAMH,GAAG,CAACI,IAAI,CAAC,CAAC;MAC7B,MAAMC,GAAG,GAAGrG,KAAK,CAACC,OAAO,CAACkG,IAAI,CAAC,GAAGA,IAAI,CAAC/F,GAAG,CAACC,CAAC,IAAI,CAAAA,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAEC,QAAQ,MAAID,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAEE,EAAE,EAAC,CAACC,MAAM,CAACC,OAAO,CAAC,GAAG,EAAE;MAC1F,IAAI4F,GAAG,CAAClG,MAAM,EAAE;QACZmF,gBAAgB,CAACe,GAAG,CAAC;QACrBb,aAAa,CAAC,IAAI,CAAC;QACnBE,aAAa,CAACY,CAAC,IAAIC,IAAI,CAACC,GAAG,CAACF,CAAC,EAAED,GAAG,CAAClG,MAAM,GAAG,CAAC,CAAC,CAAC;QAC/C,OAAO,IAAI;MACf;IACJ,CAAC,CAAC,MAAM,CAAE;IACV,OAAO,KAAK;EAChB,CAAC,EAAE,CAACoF,UAAU,EAAEV,SAAS,CAAC,CAAC;EAE3BnG,SAAS,CAAC,MAAM;IACZ,IAAI+H,SAAS,GAAG,KAAK;IACrB,CAAC,YAAY;MACT,IAAI,CAACb,MAAM,EAAE;MACb,IAAIP,aAAa,CAAClF,MAAM,GAAG,CAAC,EAAE;MAC9B,MAAM+F,EAAE,GAAG,MAAMH,WAAW,CAAC,CAAC;MAC9B,IAAI,CAACU,SAAS,IAAI,CAACP,EAAE,EAAE,CAAE;IAC7B,CAAC,EAAE,CAAC;IACJ,OAAO,MAAM;MAAEO,SAAS,GAAG,IAAI;IAAE,CAAC;EACtC,CAAC,EAAE,CAACb,MAAM,EAAEP,aAAa,CAAClF,MAAM,EAAE4F,WAAW,CAAC,CAAC;EAE/C,MAAMW,MAAM,GAAGjI,WAAW,CAAC,MAAOwG,CAAC,IAAK;IAAA,IAAA0B,kBAAA;IACpC1B,CAAC,aAADA,CAAC,wBAAA0B,kBAAA,GAAD1B,CAAC,CAAE2B,eAAe,cAAAD,kBAAA,uBAAlBA,kBAAA,CAAAE,IAAA,CAAA5B,CAAqB,CAAC;IACtB,IAAI,CAACM,UAAU,IAAIF,aAAa,CAAClF,MAAM,IAAI,CAAC,EAAE;MAC1C,MAAM+F,EAAE,GAAG,MAAMH,WAAW,CAAC,CAAC;MAC9B,IAAI,CAACG,EAAE,IAAIb,aAAa,CAAClF,MAAM,IAAI,CAAC,EAAE;IAC1C;IACAuF,aAAa,CAACY,CAAC,IAAI,CAACA,CAAC,GAAG,CAAC,GAAGjB,aAAa,CAAClF,MAAM,IAAIkF,aAAa,CAAClF,MAAM,CAAC;EAC7E,CAAC,EAAE,CAACoF,UAAU,EAAEF,aAAa,CAAClF,MAAM,EAAE4F,WAAW,CAAC,CAAC;EAEnD,MAAMe,MAAM,GAAGrI,WAAW,CAAC,MAAOwG,CAAC,IAAK;IAAA,IAAA8B,mBAAA;IACpC9B,CAAC,aAADA,CAAC,wBAAA8B,mBAAA,GAAD9B,CAAC,CAAE2B,eAAe,cAAAG,mBAAA,uBAAlBA,mBAAA,CAAAF,IAAA,CAAA5B,CAAqB,CAAC;IACtB,IAAI,CAACM,UAAU,IAAIF,aAAa,CAAClF,MAAM,IAAI,CAAC,EAAE;MAC1C,MAAM+F,EAAE,GAAG,MAAMH,WAAW,CAAC,CAAC;MAC9B,IAAI,CAACG,EAAE,IAAIb,aAAa,CAAClF,MAAM,IAAI,CAAC,EAAE;IAC1C;IACAuF,aAAa,CAACY,CAAC,IAAI,CAACA,CAAC,GAAG,CAAC,IAAIjB,aAAa,CAAClF,MAAM,CAAC;EACtD,CAAC,EAAE,CAACoF,UAAU,EAAEF,aAAa,CAAClF,MAAM,EAAE4F,WAAW,CAAC,CAAC;EAEnD,MAAMiB,WAAW,GAAG3B,aAAa,CAAClF,MAAM,GAAG,CAAC;EAE5C,MAAM8G,aAAa,GAAG,UAAUpC,SAAS,EAAE;EAC3C,MAAMqC,gBAAgB,GAAIjC,CAAC,IAAK;IAAA,IAAAkC,eAAA;IAC5B,MAAMC,IAAI,IAAAD,eAAA,GAAGlC,CAAC,CAACC,MAAM,CAACmC,KAAK,cAAAF,eAAA,uBAAdA,eAAA,CAAiB,CAAC,CAAC;IAChC,IAAIC,IAAI,IAAI9D,QAAQ,EAAEA,QAAQ,CAACL,OAAO,EAAEmE,IAAI,CAAC;IAC7CnC,CAAC,CAACC,MAAM,CAACoC,KAAK,GAAG,EAAE;EACvB,CAAC;EAED,MAAMC,KAAK,GAAGnI,QAAQ,CAAC,CAAC;EAExB,MAAMoI,eAAe,GAAG,MAAAA,CAAA,KAAY;IAChC,MAAMjD,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC;IAC9C,IAAI,CAACF,KAAK,EAAE;MAAEV,WAAW,CAAC,CAAC;MAAE;IAAQ;IACrC,IAAI;MACA,MAAM5E,SAAS,CAAC4F,SAAS,EAAE,CAAC,CAAC;MAC7B0C,KAAK,CAACE,OAAO,CAAC,qBAAqB,CAAC;IACxC,CAAC,CAAC,OAAOxC,CAAC,EAAE;MACRsC,KAAK,CAACG,KAAK,CAACzC,CAAC,CAAC0C,OAAO,IAAI,+BAA+B,CAAC;IAC7D;EACJ,CAAC;EAED,MAAMC,aAAa,GAAG,MAAAA,CAAA,KAAY;IAC9B,IAAI,CAAC/B,OAAO,IAAI,CAACrC,mBAAmB,EAAE;IACtC,IAAI;MACA,MAAMA,mBAAmB,CAACP,OAAO,EAAE4C,OAAO,CAAC;MAC3CP,gBAAgB,CAACuC,IAAI,IAAI,CAAChC,OAAO,EAAE,GAAGgC,IAAI,CAACrH,MAAM,CAACD,EAAE,IAAIA,EAAE,KAAKsF,OAAO,CAAC,CAAC,CAAC;MACzEH,aAAa,CAAC,CAAC,CAAC;IACpB,CAAC,CAAC,MAAM,CAAE;EACd,CAAC;EAED,MAAMoC,YAAY,GAAG,MAAAA,CAAA,KAAY;IAC7B,IAAI,CAACjC,OAAO,IAAI,CAACpC,kBAAkB,EAAE;IACrC,IAAI;MACA,MAAMA,kBAAkB,CAACR,OAAO,EAAE4C,OAAO,CAAC;MAC1CP,gBAAgB,CAACuC,IAAI,IAAIA,IAAI,CAACrH,MAAM,CAACD,EAAE,IAAIA,EAAE,KAAKsF,OAAO,CAAC,CAAC;MAC3DH,aAAa,CAACY,CAAC,IAAIC,IAAI,CAACwB,GAAG,CAAC,CAAC,EAAExB,IAAI,CAACC,GAAG,CAACF,CAAC,EAAEjB,aAAa,CAAClF,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;IAC1E,CAAC,CAAC,MAAM,CAAE;EACd,CAAC;EAED,MAAM,CAAC6H,gBAAgB,EAAEC,mBAAmB,CAAC,GAAGpJ,QAAQ,CAAC,KAAK,CAAC;EAE/D,MAAMqJ,UAAU,GAAGzJ,WAAW,CAAC,YAAY;IACvC,IAAI,CAACoG,SAAS,EAAE;IAChB,IAAI;MAAA,IAAAsD,KAAA,EAAAC,MAAA,EAAAC,KAAA,EAAAC,MAAA;MACAhE,gBAAgB,CAAC,IAAI,CAAC;MACtB,MAAMiE,CAAC,GAAG,MAAMvJ,gBAAgB,CAAC6F,SAAS,CAAC;MAC3C,MAAM2D,MAAM,GAAGlH,MAAM,EAAA6G,KAAA,IAAAC,MAAA,GAACG,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAEtE,GAAG,cAAAmE,MAAA,cAAAA,MAAA,GAAIG,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAEE,OAAO,cAAAN,KAAA,cAAAA,KAAA,GAAI,CAAC,CAAC;MAChD,MAAMO,MAAM,GAAGpH,MAAM,EAAA+G,KAAA,IAAAC,MAAA,GAACC,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAEI,GAAG,cAAAL,MAAA,cAAAA,MAAA,GAAIC,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAEpE,KAAK,cAAAkE,KAAA,cAAAA,KAAA,GAAI,CAAC,CAAC;MAC9C,IAAI/G,MAAM,CAACC,QAAQ,CAACiH,MAAM,CAAC,EAAEtE,MAAM,CAACsE,MAAM,CAAC;MAC3C,IAAIlH,MAAM,CAACC,QAAQ,CAACmH,MAAM,CAAC,EAAEtE,QAAQ,CAACsE,MAAM,CAAC;MAC7CT,mBAAmB,CAAC,IAAI,CAAC;IAC7B,CAAC,CAAC,MAAM,CACR,CAAC,SAAS;MACN3D,gBAAgB,CAAC,KAAK,CAAC;IAC3B;EACJ,CAAC,EAAE,CAACO,SAAS,CAAC,CAAC;EAEfnG,SAAS,CAAC,MAAM;IACZ,IAAIkH,MAAM,IAAI,CAACoC,gBAAgB,EAAE;MAC7BE,UAAU,CAAC,CAAC;IAChB;EACJ,CAAC,EAAE,CAACtC,MAAM,EAAEoC,gBAAgB,EAAEE,UAAU,CAAC,CAAC;EAE1C,oBACI3I,OAAA;IAAK8C,GAAG,EAAEsD,OAAQ;IAACiD,SAAS,EAAC,4JAA4J;IAAAC,QAAA,GAEpL5F,OAAO,CAAC6F,KAAK,IAAI,CAAC,IAAI7F,OAAO,CAAC6F,KAAK,GAAG,CAAC,iBACpCvJ,OAAA;MAAKqJ,SAAS,EAAC,4BAA4B;MAAAC,QAAA,eACvCtJ,OAAA;QAAKqJ,SAAS,EAAC,mFAAmF;QAAAC,QAAA,gBAC9FtJ,OAAA;UAAKqJ,SAAS,EAAC;QAAgE;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,eACtF3J,OAAA;UAAKqJ,SAAS,EAAC;QAA4D;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,eAClF3J,OAAA;UAAMqJ,SAAS,EAAC,oCAAoC;UAAAC,QAAA,GAAC,mDAAS,EAAC5F,OAAO,CAAC6F,KAAK;QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eACpF3J,OAAA;UAAKqJ,SAAS,EAAC;QAA2E;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAChG;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACL,CACR,EACAjG,OAAO,CAAC6F,KAAK,KAAK,CAAC,iBAChBvJ,OAAA;MAAKqJ,SAAS,EAAC,4BAA4B;MAAAC,QAAA,eACvCtJ,OAAA;QAAKqJ,SAAS,EAAC,mFAAmF;QAAAC,QAAA,gBAC9FtJ,OAAA;UAAKqJ,SAAS,EAAC;QAA6D;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,eACnF3J,OAAA;UAAMqJ,SAAS,EAAC,oCAAoC;UAAAC,QAAA,EAAC;QAAa;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACxE;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACL,CACR,EAGAjG,OAAO,CAACkG,QAAQ,iBACb5J,OAAA;MAAKqJ,SAAS,EAAC,6BAA6B;MAAAC,QAAA,eACxCtJ,OAAA;QAAKqJ,SAAS,EAAC,qGAAqG;QAAAC,QAAA,eAChHtJ,OAAA;UAAMqJ,SAAS,EAAC,mCAAmC;UAAAC,QAAA,EAAE5F,OAAO,CAACkG;QAAQ;UAAAJ,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC5E;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACL,CACR,eAGD3J,OAAA;MACIqJ,SAAS,EAAC,iGAAiG;MAC3GQ,OAAO,EAAEpE,WAAY;MAAA6D,QAAA,EAEpB/C,MAAM,gBACHvG,OAAA,CAAAE,SAAA;QAAAoJ,QAAA,gBACItJ,OAAA;UACI8J,GAAG,EAAEvD,MAAO;UACZwD,GAAG,EAAErG,OAAO,CAACsG,KAAM;UACnBX,SAAS,EAAC,8EAA8E;UACxFY,SAAS,EAAE,KAAM;UACjBC,OAAO,EAAC,MAAM;UACdC,OAAO,EAAGzE,CAAC,IAAK;YACZA,CAAC,CAAC0E,aAAa,CAACN,GAAG,GAAG,EAAE;YACxBpE,CAAC,CAAC0E,aAAa,CAACL,GAAG,GAAG,wBAAwB;UAClD;QAAE;UAAAP,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACL,CAAC,eAGF3J,OAAA;UAAKqJ,SAAS,EAAC;QAAkJ;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,EAEvKlC,WAAW,iBACRzH,OAAA,CAAAE,SAAA;UAAAoJ,QAAA,gBACItJ,OAAA;YACI,aAAU,iBAAiB;YAC3B6J,OAAO,EAAE1C,MAAO;YAChBkC,SAAS,EAAC;UAAwD;YAAAG,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACrE,CAAC,eACF3J,OAAA;YACI,aAAU,iBAAiB;YAC3B6J,OAAO,EAAEtC,MAAO;YAChB8B,SAAS,EAAC;UAAyD;YAAAG,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACtE,CAAC,eAEF3J,OAAA;YACIqK,IAAI,EAAC,QAAQ;YACb,aAAU,iBAAiB;YAC3BR,OAAO,EAAE1C,MAAO;YAChBkC,SAAS,EAAC,oLAAoL;YAC9L,cAAW,gCAAO;YAAAC,QAAA,eAElBtJ,OAAA;cAAKqJ,SAAS,EAAC,uBAAuB;cAACiB,IAAI,EAAC,MAAM;cAACC,MAAM,EAAC,cAAc;cAACC,OAAO,EAAC,WAAW;cAAAlB,QAAA,eACxFtJ,OAAA;gBAAMyK,aAAa,EAAC,OAAO;gBAACC,cAAc,EAAC,OAAO;gBAACC,WAAW,EAAE,CAAE;gBAACC,CAAC,EAAC;cAAiB;gBAAApB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACxF;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACF,CAAC,eAET3J,OAAA;YACIqK,IAAI,EAAC,QAAQ;YACb,aAAU,iBAAiB;YAC3BR,OAAO,EAAEtC,MAAO;YAChB8B,SAAS,EAAC,qLAAqL;YAC/L,cAAW,sCAAQ;YAAAC,QAAA,eAEnBtJ,OAAA;cAAKqJ,SAAS,EAAC,uBAAuB;cAACiB,IAAI,EAAC,MAAM;cAACC,MAAM,EAAC,cAAc;cAACC,OAAO,EAAC,WAAW;cAAAlB,QAAA,eACxFtJ,OAAA;gBAAMyK,aAAa,EAAC,OAAO;gBAACC,cAAc,EAAC,OAAO;gBAACC,WAAW,EAAE,CAAE;gBAACC,CAAC,EAAC;cAAc;gBAAApB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACrF;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACF,CAAC,eAET3J,OAAA;YAAKqJ,SAAS,EAAC,mEAAmE;YAAAC,QAAA,EAC7ExD,aAAa,CAACjF,GAAG,CAAC,CAACgK,CAAC,EAAE9D,CAAC,kBACpB/G,OAAA;cAEI,aAAU,iBAAiB;cAC3B6J,OAAO,EAAGnE,CAAC,IAAK;gBAAEA,CAAC,CAAC2B,eAAe,CAAC,CAAC;gBAAElB,aAAa,CAACY,CAAC,CAAC;cAAE,CAAE;cAC3DsC,SAAS,EAAE,iEACPtC,CAAC,KAAKb,UAAU,GACV,yDAAyD,GACzD,mCAAmC;YAC1C,GAPEa,CAAC;cAAAyC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAQT,CACJ;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACD,CAAC;QAAA,eACR,CACL,EAEA7F,UAAU,IAAIwC,OAAO,iBAClBtG,OAAA;UAAKqJ,SAAS,EAAC,kDAAkD;UAAAC,QAAA,gBAC7DtJ,OAAA;YACIqK,IAAI,EAAC,QAAQ;YACbR,OAAO,EAAExB,aAAc;YACvB2B,KAAK,EAAC,iFAAgB;YACtBX,SAAS,EAAC,mIAAmI;YAAAC,QAAA,eAE7ItJ,OAAA;cAAKqJ,SAAS,EAAC,SAAS;cAACiB,IAAI,EAAC,cAAc;cAACE,OAAO,EAAC,WAAW;cAAAlB,QAAA,eAC5DtJ,OAAA;gBAAM4K,CAAC,EAAC;cAA0V;gBAAApB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACpW;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACF,CAAC,eAET3J,OAAA;YACIqK,IAAI,EAAC,QAAQ;YACbR,OAAO,EAAEtB,YAAa;YACtByB,KAAK,EAAC,qEAAc;YACpBX,SAAS,EAAC,iIAAiI;YAAAC,QAAA,eAE3ItJ,OAAA;cAAKqJ,SAAS,EAAC,SAAS;cAACiB,IAAI,EAAC,MAAM;cAACC,MAAM,EAAC,cAAc;cAACC,OAAO,EAAC,WAAW;cAAAlB,QAAA,eAC1EtJ,OAAA;gBAAMyK,aAAa,EAAC,OAAO;gBAACC,cAAc,EAAC,OAAO;gBAACC,WAAW,EAAE,CAAE;gBAACC,CAAC,EAAC;cAA8H;gBAAApB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACrM;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACF,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACR,CACR;MAAA,eACH,CAAC,gBAEH3J,OAAA;QAAKqJ,SAAS,EAAC,uEAAuE;QAAAC,QAAA,gBAClFtJ,OAAA;UAAKqJ,SAAS,EAAC,0GAA0G;UAAAC,QAAA,eACrHtJ,OAAA;YAAKqJ,SAAS,EAAC,SAAS;YAACiB,IAAI,EAAC,MAAM;YAACC,MAAM,EAAC,cAAc;YAACC,OAAO,EAAC,WAAW;YAAAlB,QAAA,eAC1EtJ,OAAA;cAAMyK,aAAa,EAAC,OAAO;cAACC,cAAc,EAAC,OAAO;cAACC,WAAW,EAAE,GAAI;cAACC,CAAC,EAAC;YAA2J;cAAApB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACpO;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACL,CAAC,eACN3J,OAAA;UAAMqJ,SAAS,EAAC,mCAAmC;UAAAC,QAAA,EAAC;QAAe;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACzE;IACR;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACA,CAAC,eAGN3J,OAAA;MAAKqJ,SAAS,EAAC,KAAK;MAAAC,QAAA,gBAEhBtJ,OAAA;QAAIqJ,SAAS,EAAC,6GAA6G;QAAAC,QAAA,eACvHtJ,OAAA,CAACJ,IAAI;UAACkL,EAAE,EAAE,YAAYxF,SAAS,EAAG;UAAC+D,SAAS,EAAC,iBAAiB;UAAAC,QAAA,EACzD5F,OAAO,CAACsG;QAAK;UAAAR,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACZ;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACP,CAAC,eAGL3J,OAAA;QAAGqJ,SAAS,EAAC,yDAAyD;QAAAC,QAAA,EACjE5F,OAAO,CAACqH;MAAW;QAAAvB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACrB,CAAC,eAGJ3J,OAAA;QAAKqJ,SAAS,EAAC,wBAAwB;QAAAC,QAAA,gBACnCtJ,OAAA;UAAKqJ,SAAS,EAAC,wBAAwB;UAAAC,QAAA,gBACnCtJ,OAAA,CAACT,UAAU;YAACmC,MAAM,EAAEgD,GAAI;YAACsG,IAAI,EAAC;UAAI;YAAAxB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,eACrC3J,OAAA;YAAMqJ,SAAS,EAAC,sCAAsC;YAAAC,QAAA,EAAE5E,GAAG,CAACuG,OAAO,CAAC,CAAC;UAAC;YAAAzB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC7E,CAAC,EACL7E,aAAa,gBACV9E,OAAA;UAAKqJ,SAAS,EAAC,mBAAmB;UAAAC,QAAA,gBAC9BtJ,OAAA;YAAKqJ,SAAS,EAAC;UAAsF;YAAAG,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eAC5G3J,OAAA;YAAMqJ,SAAS,EAAC,uBAAuB;YAAAC,QAAA,EAAC;UAAW;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACzD,CAAC,GACN/E,KAAK,GAAG,CAAC,gBACT5E,OAAA;UAAMqJ,SAAS,EAAC,mCAAmC;UAAAC,QAAA,GAAC,GAAC,EAAC1E,KAAK,EAAC,GAAC;QAAA;UAAA4E,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,gBAEpE3J,OAAA;UAAMqJ,SAAS,EAAC,uBAAuB;UAAAC,QAAA,EAAC;QAAW;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAC5D;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACA,CAAC,eAGN3J,OAAA;QAAKqJ,SAAS,EAAE,qBAAqBxF,OAAO,GAAG,iBAAiB,GAAG,eAAe,OAAQ;QAAAyF,QAAA,gBACtFtJ,OAAA;UAAKqJ,SAAS,EAAC,eAAe;UAAAC,QAAA,gBAC1BtJ,OAAA;YAAMqJ,SAAS,EAAC,+FAA+F;YAAAC,QAAA,EAC1G9J,WAAW,CAACkE,OAAO,CAACwH,KAAK;UAAC;YAAA1B,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACzB,CAAC,EACNjG,OAAO,CAACyH,QAAQ,iBACbnL,OAAA;YAAMqJ,SAAS,EAAC,oCAAoC;YAAAC,QAAA,EAAE9J,WAAW,CAACkE,OAAO,CAACyH,QAAQ;UAAC;YAAA3B,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAC7F;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACA,CAAC,EAEL9F,OAAO,IAAIuB,MAAM,iBACdpF,OAAA;UACI6J,OAAO,EAAE5B,eAAgB;UACzBoB,SAAS,EAAC,+GAA+G;UAAAC,QAAA,gBAEzHtJ,OAAA;YAAKqJ,SAAS,EAAC;UAAmH;YAAAG,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eACzI3J,OAAA;YAAKqJ,SAAS,EAAC;UAA6J;YAAAG,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eACnL3J,OAAA;YAAMqJ,SAAS,EAAC,oEAAoE;YAAAC,QAAA,gBAChFtJ,OAAA;cAAKqJ,SAAS,EAAC,SAAS;cAACiB,IAAI,EAAC,MAAM;cAACC,MAAM,EAAC,cAAc;cAACC,OAAO,EAAC,WAAW;cAAAlB,QAAA,eAC1EtJ,OAAA;gBAAMyK,aAAa,EAAC,OAAO;gBAACC,cAAc,EAAC,OAAO;gBAACC,WAAW,EAAE,CAAE;gBAACC,CAAC,EAAC;cAA4B;gBAAApB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACnG,CAAC,eACN3J,OAAA;cAAAsJ,QAAA,EAAM;YAAS;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACpB,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CACX;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACA,CAAC,EAGL,CAAChG,SAAS,IAAIG,UAAU,kBACrB9D,OAAA;QAAKqJ,SAAS,EAAC,+BAA+B;QAAAC,QAAA,gBAC1CtJ,OAAA;UAAKqJ,SAAS,EAAC,sBAAsB;UAAAC,QAAA,GAChC3F,SAAS,iBACN3D,OAAA;YACI6J,OAAO,EAAEA,CAAA,KAAMjG,MAAM,IAAIA,MAAM,CAACF,OAAO,CAAE;YACzC2F,SAAS,EAAC,6FAA6F;YAAAC,QAAA,gBAEvGtJ,OAAA;cAAKqJ,SAAS,EAAC;YAAqH;cAAAG,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eAC3I3J,OAAA;cAAKqJ,SAAS,EAAC;YAAsF;cAAAG,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eAC5G3J,OAAA;cAAMqJ,SAAS,EAAC,wEAAwE;cAAAC,QAAA,gBACpFtJ,OAAA;gBAAKqJ,SAAS,EAAC,SAAS;gBAACiB,IAAI,EAAC,MAAM;gBAACC,MAAM,EAAC,cAAc;gBAACC,OAAO,EAAC,WAAW;gBAAAlB,QAAA,eAC1EtJ,OAAA;kBAAMyK,aAAa,EAAC,OAAO;kBAACC,cAAc,EAAC,OAAO;kBAACC,WAAW,EAAE,CAAE;kBAACC,CAAC,EAAC;gBAAwH;kBAAApB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC/L,CAAC,eACN3J,OAAA;gBAAAsJ,QAAA,EAAM;cAAa;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACxB,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CACX,EAEAhG,SAAS,IAAIS,WAAW,iBACrBpE,OAAA;YACI6J,OAAO,EAAEA,CAAA,KAAMzF,WAAW,CAACV,OAAO,CAAE;YACpC2F,SAAS,EAAC,6FAA6F;YAAAC,QAAA,gBAEvGtJ,OAAA;cAAKqJ,SAAS,EAAC;YAAqH;cAAAG,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eAC3I3J,OAAA;cAAKqJ,SAAS,EAAC;YAAoF;cAAAG,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eAC1G3J,OAAA;cAAMqJ,SAAS,EAAC,uEAAuE;cAAAC,QAAA,gBACnFtJ,OAAA;gBAAKqJ,SAAS,EAAC,SAAS;gBAACiB,IAAI,EAAC,MAAM;gBAACC,MAAM,EAAC,cAAc;gBAACC,OAAO,EAAC,WAAW;gBAAAlB,QAAA,eAC1EtJ,OAAA;kBAAMyK,aAAa,EAAC,OAAO;kBAACC,cAAc,EAAC,OAAO;kBAACC,WAAW,EAAE,CAAE;kBAACC,CAAC,EAAC;gBAAiE;kBAAApB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACxI,CAAC,eACN3J,OAAA;gBAAAsJ,QAAA,EAAM;cAAK;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAChB,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CACX,EAEA7F,UAAU,iBACP9D,OAAA,CAAAE,SAAA;YAAAoJ,QAAA,gBACItJ,OAAA;cAAOgB,EAAE,EAAE0G,aAAc;cAAC2C,IAAI,EAAC,MAAM;cAACe,MAAM,EAAC,SAAS;cAAC/B,SAAS,EAAC,QAAQ;cAACgC,QAAQ,EAAE1D;YAAiB;cAAA6B,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE,CAAC,eACxG3J,OAAA;cACIsL,OAAO,EAAE5D,aAAc;cACvB2B,SAAS,EAAC,4GAA4G;cAAAC,QAAA,gBAEtHtJ,OAAA;gBAAKqJ,SAAS,EAAC;cAA6G;gBAAAG,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC,eACnI3J,OAAA;gBAAKqJ,SAAS,EAAC;cAAgF;gBAAAG,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC,eACtG3J,OAAA;gBAAMqJ,SAAS,EAAC,qEAAqE;gBAAAC,QAAA,gBACjFtJ,OAAA;kBAAKqJ,SAAS,EAAC,SAAS;kBAACiB,IAAI,EAAC,MAAM;kBAACC,MAAM,EAAC,cAAc;kBAACC,OAAO,EAAC,WAAW;kBAAAlB,QAAA,eAC1EtJ,OAAA;oBAAMyK,aAAa,EAAC,OAAO;oBAACC,cAAc,EAAC,OAAO;oBAACC,WAAW,EAAE,CAAE;oBAACC,CAAC,EAAC;kBAAgE;oBAAApB,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAE;gBAAC;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACvI,CAAC,eACN3J,OAAA;kBAAAsJ,QAAA,EAAM;gBAAc;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACzB,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACJ,CAAC;UAAA,eACV,CACL;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACA,CAAC,EAGLhG,SAAS,IAAIQ,SAAS,iBACnBnE,OAAA;UAAKqJ,SAAS,EAAC,oCAAoC;UAAAC,QAAA,eAC/CtJ,OAAA;YAAKqJ,SAAS,EAAC,gCAAgC;YAAAC,QAAA,gBAC3CtJ,OAAA;cAAKqJ,SAAS,EAAC,yEAAyE;cAAAC,QAAA,gBACpFtJ,OAAA;gBAAMqJ,SAAS,EAAC,oBAAoB;gBAAAC,QAAA,EAAC;cAAS;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC,eACrD3J,OAAA;gBAAMqJ,SAAS,EAAC,iCAAiC;gBAAAC,QAAA,GAAEnF,SAAS,CAACoH,SAAS,EAAC,gBAAI;cAAA;gBAAA/B,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACjF,CAAC,EACL,OAAOxF,SAAS,CAACqH,gBAAgB,KAAK,QAAQ,iBAC3CxL,OAAA;cAAKqJ,SAAS,EAAC,0EAA0E;cAAAC,QAAA,gBACrFtJ,OAAA;gBAAMqJ,SAAS,EAAC,oBAAoB;gBAAAC,QAAA,EAAC;cAAS;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC,eACrD3J,OAAA;gBAAMqJ,SAAS,EAAC,kCAAkC;gBAAAC,QAAA,GAAEnF,SAAS,CAACqH,gBAAgB,EAAC,gBAAI;cAAA;gBAAAhC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACzF,CACR;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACA;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACL,CACR;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACA,CACR;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACA,CAAC,eAGN3J,OAAA;MAAKqJ,SAAS,EAAC;IAAiI;MAAAG,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAM,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACtJ,CAAC;AAEd,CAAC;AAACtF,GAAA,CAxbIZ,WAAW;EAAA,QA2BI9D,WAAW,EAaFgD,iBAAiB,EA2D7B9C,QAAQ;AAAA;AAAA4L,EAAA,GAnGpBhI,WAAW;AA0bjB,eAAeA,WAAW;AAAC,IAAAgI,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}